<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tính PLC Áp</title>
    <link rel="stylesheet" href="style.css">
    <style>
        /* Căn giữa và màu xanh cho tiêu đề các chức năng */
        .input-group h3 {
            text-align: center;
            color: blue;
            font-weight: bold;
            margin-top: 0;
            font-size: 18px;
        }
    </style>
</head>
<body>
    <h1>CÔNG CỤ HỖ TRỢ TÍNH TOÁN-CHUYỂN ĐỔI THÔNG SỐ DCS</h1>
    <div id="clock"></div>
    <div class="container">
        <h2>TÍNH TOÁN -CHUYỂN ĐỔI THÔNG SỐ CHO MODULE ANALOG PLC (ĐO ÁP)</h2>
        <p style="text-align: center; font-style: italic;">Áp dụng cho PLC Siemens</p>
        
        <div class="input-group">
            <h3>1. Tính giá trị Scaling của điểm (Raw -> Thực)</h3>
            <label>Điểm Zero:</label><input type="number" id="z1" placeholder="Ví dụ: 0">
            <label>Điểm Span:</label><input type="number" id="s1" placeholder="Ví dụ: 100">
            <label>Giá trị Raw (Thô):</label><input type="number" id="r1" placeholder="Nhập từ 0 đến 27648">
            <button onclick="calcScale()">Quy đổi Scaling</button>
            <div id="res1" class="result">Kết quả: ...</div>
            <div class="tech-note">
                Được ứng dụng để tính giá trị vật lý thực tế từ giá trị số (Raw) mà module đo áp 0-10V nhận được. Dãy Raw Siemens tiêu chuẩn là 0 - 27648.
            </div>
        </div>

        <div class="input-group">
            <h3>2. Quy đổi từ giá trị Scaling sang giá trị Raw (Thực -> Raw)</h3>
            <label>Điểm Zero:</label><input type="number" id="z2" placeholder="Ví dụ: 0">
            <label>Điểm Span:</label><input type="number" id="s2" placeholder="Ví dụ: 100">
            <label>Giá trị Scaling:</label><input type="number" id="v2" placeholder="Nhập giá trị vật lý">
            <button onclick="calcRaw()">Quy đổi Raw</button>
            <div id="res2" class="result">Kết quả: ...</div>
            <div class="tech-note">
                Được ứng dụng để tìm giá trị Raw tương ứng với giá trị vật lý mong muốn để nạp vào PLC (Dãy Raw từ 0 đến 27648).
            </div>
        </div>

        <a href="index.html" class="btn-link btn-back">Quay lại trang chính</a>
    </div>

    <script>
        function updateClock() { 
            const now = new Date();
            document.getElementById('clock').innerText = "Thời gian thực: " + now.toLocaleString('vi-VN'); 
        }
        setInterval(updateClock, 1000); 
        updateClock();

        function calcScale() {
            let zero = parseFloat(document.getElementById('z1').value);
            let span = parseFloat(document.getElementById('s1').value);
            let raw = parseFloat(document.getElementById('r1').value);
            
            if (isNaN(zero) || isNaN(span) || isNaN(raw)) { alert("Vui lòng nhập đủ thông số"); return; }

            let res = (raw / 27648) * (span - zero) + zero;
            document.getElementById('res1').innerHTML = `Tương ứng Giá trị Raw (Thô) quy đổi Scaling là: <b>${res.toFixed(2)}</b>`;
        }

        function calcRaw() {
            let zero = parseFloat(document.getElementById('z2').value);
            let span = parseFloat(document.getElementById('s2').value);
            let val = parseFloat(document.getElementById('v2').value);
            
            if (isNaN(zero) || isNaN(span) || isNaN(val)) { alert("Vui lòng nhập đủ thông số"); return; }
            if (span === zero) { alert("Span và Zero không được bằng nhau"); return; }

            let res = ((val - zero) / (span - zero)) * 27648;
            document.getElementById('res2').innerHTML = `Tương ứng Giá trị Scaling quy đổi Giá trị Raw (Thô) là: <b>${Math.round(res)}</b> <br> (Dãy Giá trị Raw của module là từ 0 đến 27648)`;
        }
    </script>
</body>
</html>
