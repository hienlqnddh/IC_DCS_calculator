<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tính PLC Áp</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div id="clock">...</div>
    <div class="container">
        <h1>CÔNG CỤ HỖ TRỢ TÍNH TOÁN-CHUYỂN ĐỔI THÔNG SỐ DCS</h1>
        <h2>TÍNH TOÁN -CHUYỂN ĐỔI THÔNG SỐ CHO MODULE ANALOG PLC (Đo áp)</h2>
        <p style="text-align: center;">(Áp dụng cho PLC Siemens)</p>

        <div class="input-group">
            <h3>CN1: Tính Scale (Dạng 0-10V)</h3>
            <label>Zero / Span:</label>
            <input type="number" id="plc_v1_zero" placeholder="Zero">
            <input type="number" id="plc_v1_span" placeholder="Span" style="margin-top:5px;">
            <label>Giá trị Raw (Thô):</label><input type="number" id="plc_v1_raw">
            <button onclick="calcPLC_V1()">Quy đổi</button>
            <div class="result" id="res_plc_v1">Kết quả: ...</div>
            <div class="tech-note">Scale = ((Raw / 27648) * (Span - Zero)) + Zero</div>
        </div>

        <div class="input-group">
            <h3>CN2: Tính Raw từ Scale (Dạng 0-10V)</h3>
            <label>Zero / Span:</label>
            <input type="number" id="plc_v2_zero" placeholder="Zero">
            <input type="number" id="plc_v2_span" placeholder="Span" style="margin-top:5px;">
            <label>Giá trị Scaling:</label><input type="number" id="plc_v2_val">
            <button onclick="calcPLC_V2()">Quy đổi Raw</button>
            <div class="result" id="res_plc_v2">Kết quả: ...</div>
            <div class="tech-note">Raw = ((Value - Zero) / (Span - Zero)) * 27648</div>
        </div>

        <a href="index.html" class="btn-link btn-back">Quay lại trang chính</a>
    </div>

    <script>
        function updateClock() {
            const now = new Date();
            document.getElementById('clock').innerText = "Thời gian thực: " + now.toLocaleString('vi-VN');
        }
        setInterval(updateClock, 1000); updateClock();

        function plcScale(raw, z, s) { return ((raw / 27648) * (s - z)) + z; }
        function plcRaw(val, z, s) { return ((val - z) / (s - z)) * 27648; }

        function calcPLC_V1() {
            let z = parseFloat(document.getElementById('plc_v1_zero').value);
            let s = parseFloat(document.getElementById('plc_v1_span').value);
            let r = parseFloat(document.getElementById('plc_v1_raw').value);
            let res = plcScale(r, z, s);
            document.getElementById('res_plc_v1').innerText = `Scaling: ${res.toFixed(2)}`;
        }

        function calcPLC_V2() {
            let z = parseFloat(document.getElementById('plc_v2_zero').value);
            let s = parseFloat(document.getElementById('plc_v2_span').value);
            let v = parseFloat(document.getElementById('plc_v2_val').value);
            let res = plcRaw(v, z, s);
            document.getElementById('res_plc_v2').innerText = `Raw: ${Math.round(res)}`;
        }
    </script>
</body>
</html>
