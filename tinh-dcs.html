<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tính thông số DCS</title>
    <link rel="stylesheet" href="style.css">
    <style>
        /* Căn giữa và màu xanh cho tiêu đề các chức năng */
        .input-group h3 {
            text-align: center;
            color: blue;
            font-weight: bold;
            margin-top: 0;
        }
        /* Style riêng cho phần ghi chú ứng dụng */
        .app-note {
            font-size: 14px;
            color: #28a745;
            font-style: italic;
            margin-bottom: 10px;
            display: block;
            text-align: center;
        }
    </style>
</head>
<body>
    <h1>CÔNG CỤ HỖ TRỢ TÍNH TOÁN-CHUYỂN ĐỔI THÔNG SỐ DCS</h1>
    <div id="clock"></div>
    <div class="container">
        <h2>TÍNH TOÁN -CHUYỂN ĐỔI THÔNG SỐ CHO MODULE ANALOG DCS</h2>
        
        <div class="input-group">
            <h3>1. Tính hệ số a, b</h3>
            <span class="app-note">Được ứng dụng để tính hệ số a, b dùng trong quá trình tạo Point và thay đổi dãy của point,...</span>
            <label>Điểm Zero:</label><input type="number" id="z1" placeholder="Ví dụ: 0">
            <label>Điểm Span:</label><input type="number" id="s1" placeholder="Ví dụ: 100">
            <button onclick="calcDCS1()">Tính hệ số</button>
            <div id="resDCS1" class="result">Kết quả: ...</div>
            <div class="tech-note">
                <b>Công thức:</b><br>
                $Cc1(a) = \frac{Span - Zero}{0.016}$ <br>
                $Cc2(b) = Zero - (0.004 \times a)$
            </div>
        </div>

        <div class="input-group">
            <h3>2. Tính Span từ đo thực tế</h3>
            <span class="app-note">Được ứng dụng để tìm dãy đo thực tế của point dựa vào giá trị làm việc và dòng đang vận hành</span>
            <label>Điểm Zero:</label><input type="number" id="z2" placeholder="Ví dụ: 0">
            <label>Dòng tín hiệu x (mA):</label><input type="number" id="x2" placeholder="Ví dụ: 12">
            <label>Giá trị đo hiện tại y:</label><input type="number" id="y2" placeholder="Giá trị hiển thị trên DCS">
            <button onclick="calcDCS2()">Tính Span</button>
            <div id="resDCS2" class="result">Kết quả: ...</div>
            <div class="tech-note">
                <b>Công thức:</b><br>
                $Span = Zero + 16 \times \frac{y - Zero}{x - 4}$
            </div>
        </div>

        <div class="input-group">
            <h3>3. Tính giá trị đo từ mA</h3>
            <span class="app-note">Được ứng dụng để tìm giá trị Scale của Point dựa vào dòng thực tế module nhận được</span>
            <label>Điểm Zero:</label><input type="number" id="z3" placeholder="Ví dụ: 0">
            <label>Điểm Span:</label><input type="number" id="s3" placeholder="Ví dụ: 100">
            <label>Dòng tín hiệu x (mA):</label><input type="number" id="x3" placeholder="Ví dụ: 20">
            <button onclick="calcDCS3()">Tính Giá trị</button>
            <div id="resDCS3" class="result">Kết quả: ...</div>
            <div class="tech-note">
                <b>Công thức:</b><br>
                $Value = Zero + \frac{Span - Zero}{16} \times (x - 4)$
            </div>
        </div>

        <a href="index.html" class="btn-link btn-back">Quay lại trang chính</a>
    </div>

    <script>
        function updateClock() { 
            const now = new Date();
            document.getElementById('clock').innerText = "Thời gian thực: " + now.toLocaleString('vi-VN'); 
        }
        setInterval(updateClock, 1000); 
        updateClock();

        function calcDCS1() {
            let zero = parseFloat(document.getElementById('z1').value);
            let span = parseFloat(document.getElementById('s1').value);
            if (isNaN(zero) || isNaN(span)) { alert("Vui lòng nhập đủ Zero và Span"); return; }
            
            let a = (span - zero) / 0.016;
            let b = zero - (0.004 * a);
            document.getElementById('resDCS1').innerHTML = `Hệ số Cc1(a) = <b>${a.toFixed(4)}</b> <br> Hệ số Cc2(b) = <b>${b.toFixed(4)}</b>`;
        }

        function calcDCS2() {
            let z = parseFloat(document.getElementById('z2').value);
            let x = parseFloat(document.getElementById('x2').value);
            let y = parseFloat(document.getElementById('y2').value);
            if (isNaN(z) || isNaN(x) || isNaN(y)) { alert("Vui lòng nhập đủ thông số"); return; }
            if (x === 4) { alert("Dòng mA phải khác 4 để tránh lỗi chia cho 0"); return; }

            let span = z + 16 * ((y - z) / (x - 4));
            document.getElementById('resDCS2').innerHTML = `Dãy làm việc: từ <b>${z}</b> đến <b>${span.toFixed(2)}</b>`;
        }

        function calcDCS3() {
            let z = parseFloat(document.getElementById('z3').value);
            let s = parseFloat(document.getElementById('s3').value);
            let x = parseFloat(document.getElementById('x3').value);
            if (isNaN(z) || isNaN(s) || isNaN(x)) { alert("Vui lòng nhập đủ thông số"); return; }

            let val = z + ((s - z) / 16) * (x - 4);
            document.getElementById('resDCS3').innerHTML = `Giá trị đo được (tương đương ${x} mA) là: <b>${val.toFixed(2)}</b>`;
        }
    </script>
</body>
</html>
